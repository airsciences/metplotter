(function(){var t
window.Plotting||(window.Plotting={}),window.Plotting.API=t=function(){function t(t,i){var e
this.preError="Plotting.API",e=this.preError+".constructor()",this.async=!0,"undefined"!=typeof i&&(this.async=i),this.getAccessToken=function(){return t},this.getAccessTokenValue=function(){return"Token "+t}}return t.prototype.build=function(){var t,i,e
if(i=this.preError+".build()",e=null,XMLHttpRequest)e=new XMLHttpRequest
else try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(n){t=n
try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){t=e,console.error(i,"Cannot specify XMLHTTPRequest (error)",t)}}return e},t.prototype.get=function(t,i,e){var n,o,a
o=this.preError+".get(uri, params, callback)",a=this.build(),"undefined"!=typeof e&&(a.onreadystatechange=function(){var t,i
if(4===a.readyState){if(200!==a.status&&304!==a.status)return console.log(o+" HTTP error, (status): "+a.status),void(a=null)
i={response:a.response,responseText:a.responseText,responseJSON:null}
try{i.responseJSON=JSON.parse(i.responseText)}catch(e){t=e,i.responseJSON=null}return e(i)}}),i=this.encodeArgs("GET",i)
try{a.open("GET",t+i,this.async),a.setRequestHeader("Authorization",this.getAccessTokenValue()),a.send(null)}catch(t){n=t,console.log(o+"catch(error).",n)}},t.prototype.put=function(){var t,i,e,n
e=this.preError+".put(uri, params, callback)",n=this.build(),"undefined"!=typeof callback&&(n.onreadystatechange=function(){var t,i
if(4===n.readyState){if(200!==n.status&&304!==n.status)return console.log(e+" HTTP error, (status): "+n.status),void(n=null)
i={response:n.response,responseText:n.responseText,responseJSON:null}
try{i.responseJSON=JSON.parse(i.responseText)}catch(e){t=e,i.responseJSON=null}return callback(i)}}),t=this.encodeArgs("PUT",t)
try{n.open("PUT",uri,this.async),n.setRequestHeader("Authorization",this.getAccessToken()),n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.send(t)}catch(t){i=t,console.log(e+"catch(error).",i)}},t.prototype.post=function(){var t,i,e,n
e=this.preError+".post(uri, params, callback)",n=build(),"undefined"!=typeof callback&&(n.onreadystatechange=function(){var t,i
if(4===n.readyState){if(200!==n.status&&304!==n.status)return console.log(e+" HTTP error, (status): "+n.status),void(n=null)
i={response:n.response,responseText:n.responseText,responseJSON:null}
try{i.responseJSON=JSON.parse(i.responseText)}catch(e){t=e,i.responseJSON=null}return callback(i)}}),t=this.encodeArgs("POST",t)
try{n.open("POST",uri,this.async),n.setRequestHeader("Authorization",this.getAccessToken()),n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.send(t)}catch(t){i=t,console.log(e+"catch(error).",i)}},t.prototype.delete=function(){var t,i,e,n
e=this.preError+".delete(uri, params, callback)",n=this.build(),"undefined"!=typeof callback&&(n.onreadystatechange=function(){var t,i
if(4===n.readyState){if(200!==n.status&&304!==n.status)return console.log(e+" HTTP error, (status): "+n.status),void(n=null)
i={response:n.response,responseText:n.responseText,responseJSON:null}
try{i.responseJSON=JSON.parse(i.responseText)}catch(e){t=e,i.responseJSON=null}return callback(i)}}),t=this.encodeArgs("DELETE",t)
try{n.open("DELETE",uri,this.async),n.setRequestHeader("Authorization",this.getAccessToken()),n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.send(t)}catch(t){i=t,console.log(e+"catch(error).",i)}},t.prototype.encodeArgs=function(t,i){var e,n,o,a,s
if(s=this.preError+"encodeArgs(type, json_args)",n="",e=0,"string"==typeof i)try{i=JSON.parse(i)}catch(t){a=t,console.log(s+"catch(error).",a)}if("POST"===t||"PUT"===t)n=JSON.stringify(i)
else if("GET"===t)for(o in i)n=0===e?"?"+o+"="+i[o]:n+"&"+o+"="+i[o],e++
return n},t}()}).call(this),function(){var t,i=[].indexOf||function(t){for(var i=0,e=this.length;i<e;i++)if(i in this&&this[i]===t)return i
return-1}
window.Plotting||(window.Plotting={}),window.Plotting.Controls=t=function(){function t(t,i,e){var n,o
this.preError="Plotting.Dropdown",this.plotter=t,o={target:null},this.options=Object.mergeDefaults(e,o),n={token:null,expires:null,expired:!0},i=Object.mergeDefaults(i,n),this.current=[],this.stations=[],this.maps=[],this.markers={},this.listeners={},this.api=new window.Plotting.API(i.token)}return t.prototype.setCurrent=function(t){var i,e,n,o,a,s,r
for(this.current[t]=[],s=["y","y2","y3"],r=[],n=0,a=s.length;n<a;n++)o=s[n],i=this.plotter.template[t].proto.options[o],null!==i.dataLoggerId?(e={dataLoggerId:parseInt(i.dataLoggerId),yTarget:o,color:i.color},r.push(this.current[t].push(e))):r.push(void 0)
return r},t.prototype.getCurrent=function(t){return t>=0?this.current[t]:this.current},t.prototype.updateStationStates=function(t){var i,e,n,o,a,s,r,l,p
if(this.setCurrent(t),this.stations[t].length>0){for(s=this.stations[t],l=[],o=0,a=s.length;o<a;o++)r=s[o],r.displayed=[],l.push(function(){var o,a,s,l
for(s=r.dataloggers,l=[],o=0,a=s.length;o<a;o++)p=s[o],p.displayed=!1,p.color="",e=this.plotter.indexOfValue(this.current[t],"dataLoggerId",p.id),e>-1?(i=this.current[t][e].color,p.displayed=!0,p.color=i,n={dataLoggerId:p.id,color:i},l.push(r.displayed.push(n))):l.push(void 0)
return l}.call(this))
return l}},t.prototype.appendStationDropdown=function(t,i,e,n){var o,a,s,r,l
return r=location.protocol+"//dev.nwac.us/api/v5/dataloggerregion?sensor_name="+e,o=this,a={},l=this.uuid(),this.setCurrent(t),s=function(e){var a,s,r,p,d,h,u,c,m,f
for(o.stations[t]=e.responseJSON.results,s='<div class="dropdown"> <li><a id="'+l+'" class="station-dropdown dropdown-toggle" role="button" data-toggle="dropdown" href="#"> <i class="icon-list"></i></a> <ul id="station-dropdown-'+t+'" class="dropdown-menu pull-right">',u=o.stations[t],r=0,d=u.length;r<d;r++){for(m=u[r],a=o.__lcname(m.name),s=s+' <li class="subheader"> <a data-region="'+a+'" data-plot-id="'+t+'" href=""> <i class="icon-caret-down" style="margin-right: 6px"></i> <span class="region-name">'+m.name+'</span> <span class="region-dots"></span> </a> </li> <ul class="list-group-item sublist" style="display: none;">',c=m.dataloggers,p=0,h=c.length;p<h;p++)f=c[p],s=s+' <li class="station" data-station-id="'+f.id+'" data-plot-id="'+t+'" style="padding: 1px 5px; cursor: pointer; list-style-type: none"> <i class="icon-circle"></i> <span class="station-name"> '+f.datalogger_name+" | "+f.elevation+" ft </span> </li>"
s+=" </ul>"}return s+=" </ul> </li>",$(i).prepend(s),$("#"+l).dropdown(),o.bindSubMenuEvent(".subheader"),o.updateStationDropdown(t),o.appendStationMap(t,i,e.responseJSON.results,n)},this.api.get(r,a,s)},t.prototype.updateStationDropdown=function(t){var i,e,n,o,a,s,r,l,p,d,h,u,c,m,f,y
for(i=this,this.updateStationStates(t),n=function(t){var i,e,n,o
for(i="",e=0,n=t.length;e<n;e++)o=t[e],i=i+' <i style="color: '+o.color+';" class="icon-circle"></i>'
return i},e=function(t,i,e){return e.displayed?$('[data-station-id="'+e.id+'"][data-plot-id="'+t+'"]').off("click").on("click",function(t){var e
return t.stopPropagation(),e=$(this).attr("data-plot-id"),$(this).append('<i class="icon-spinner icon-spin" data-plot-id="'+e+'"></i>'),i.removeStation(e,$(this).attr("data-station-id"))}):$('[data-station-id="'+e.id+'"][data-plot-id="'+t+'"]').off("click").on("click",function(t){var e
return t.stopPropagation(),e=$(this).attr("data-plot-id"),$(this).append('<i class="icon-spinner icon-spin" data-plot-id="'+e+'"></i>'),i.addStation(e,$(this).attr("data-station-id"))})},u=this.stations[t],f=[],l=0,d=u.length;l<d;l++){for(m=u[l],a=this.__lcname(m.name),s="",r="",o="",m.displayed.length>0&&(o="rgb(248, 248, 248)",r=700,s=n(m.displayed)),c=m.dataloggers,p=0,h=c.length;p<h;p++)y=c[p],$('[data-station-id="'+y.id+'"][data-plot-id="'+t+'"]> i.icon-circle').css("color",y.color),e(t,i.plotter,y)
$('[data-region="'+a+'"][data-plot-id="'+t+'"]').css("background-color",o).css("font-weight",r),f.push($('[data-region="'+a+'"][data-plot-id="'+t+'"] > span.region-dots').html(s))}return f},t.prototype.removeSpinner=function(t){return $('i.icon-spinner[data-plot-id="'+t+'"]').remove()},t.prototype.appendParameterDropdown=function(t,e,n,o){var a,s,r,l,p
return l=location.protocol+"//dev.nwac.us/api/v5/sensortype?sensors__data_logger="+n,s={},p=this.uuid(),a=[],r=function(n){var a,s,r,l,d,h,u,c,m,f
for(l='<div class="dropdown"> <li><a id="'+p+'" class="parameter-dropdown dropdown-toggle" role="button" data-toggle="dropdown" href="#"> <i class="icon-list"></i></a> <ul id="param-dropdown-'+t+'" class="dropdown-menu pull-right" role="menu" aria-labelledby="'+p+'">',m=n.responseJSON.results,d=0,u=m.length;d<u;d++)c=m[d],"wind_speed_minimum"===c.field_name||"wind_speed_maximum"===c.field_name||("wind_speed_average"===c.field_name?(a=c.field_name,s=a.replace("_","-"),h=s+"-plot-"+t,f=o.variable,i.call(c.field_name,f)>=0&&(r='<i id="'+h+'" class="parameter-'+c.parameter+' icon-circle" style="color: '+o.color+'"></i>')):(a=c.field_name,s=a.replace("_","-"),h=s+"-plot-"+t,r=o.variable===c.field_name?'<i id="'+h+'" class="icon-circle" style="color: '+o.color+'"></i>':'<i id="'+h+'" class="icon-circle" style=""></i>')),l=l+' <li><a style="cursor: pointer" onclick="plotter.addVariable('+t+", '"+a+"')\">"+r+" "+c.sensortype_name+"</a></li>"
return l+=" </ul> </li> </div>",$(e).prepend(l),$("#"+p).dropdown()},this.api.get(l,s,r)},t.prototype.updateParameterDropdown=function(t){var i,e,n
if(e=this.plotter.template[t].proto.options,null!==e.y.variable&&(i=e.y.variable.replace("_","-"),n=i+"-plot-"+t,$(e.target).find("#"+n).css("color",e.y.color)),null!==e.y2.variable&&(i=e.y2.variable.replace("_","-"),n=i+"-plot-"+t,$(e.target).find("#"+n).css("color",e.y2.color)),null!==e.y3.variable)return i=e.y3.variable.replace("_","-"),n=i+"-plot-"+t,$(e.target).find("#"+n).css("color",e.y3.color)},t.prototype.appendStationMap=function(t,i,e,n){var o,a,s,r,l,p,d,h,u,c,m,f,y,g,v,x,b,w,P,_,D,S,M,T
for(o=this,T=this.uuid(),u="map-control-"+t,c='<li data-toggle="popover" data-placement="left"> <i id="map-'+t+'" class="icon-map-marker" style="cursor: pointer"></i> </li> <div class="popover" style="max-width: 356px;"> <div class="arrow"></div> <div class="popover-content"> <div id="'+u+'" style="width: 312px; height: 312px;"></div> </div> </div>',$(i).prepend(c),$("#map-"+t).on("click",function(){return o.plotter.controls.toggleMap(t)}),this.maps[t]=new google.maps.Map(document.getElementById(u),{center:new google.maps.LatLng(46.98,-121.98),zoom:6,maxZoom:12,mapTypeId:"terrain",zoomControl:!0,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!1}),f=new google.maps.InfoWindow({content:"",disableAutoPan:!0}),this.markers[t]=[],this.listeners[t]=[],s=new google.maps.LatLngBounds,a=[],m=0,v=e.length;m<v;m++)for(D=e[m],_=D.dataloggers,y=0,x=_.length;y<x;y++)M=_[y],h="rgb(200,200,200)",S=5,P=.5,d="map-plot-"+t+"-station-"+M.id,p=o.isCurrent(n,"dataLoggerId",M.id),p&&(h=p.color,S=7,P=.8,a.push(new google.maps.LatLng(M.lat,M.lon))),w=new google.maps.Marker({position:{lat:M.lat,lng:M.lon},id:d,tooltip:M.datalogger_name+" - "+M.elevation+" ft",dataLoggerId:M.id,icon:{path:google.maps.SymbolPath.CIRCLE,scale:S,strokeWeight:2,fillOpacity:P,fillColor:h},selected:!1}),w.addListener("mouseover",function(){return f.setContent(this.tooltip),f.open(o.maps[t],this)}),w.addListener("mouseout",function(){return f.close()}),this.listeners[t][d]=w.addListener("click",function(){return o.plotter.addStation(t,this.dataLoggerId)}),r=this.markers[t][d]=w,this.markers[t][d].setMap(this.maps[t])
for(g=0,b=a.length;g<b;g++)l=a[g],s.extend(l)
return this.maps[t].fitBounds(s)},t.prototype.resetStationMap=function(t){var i,e,n,o,a
i=this,o=this.markers[t],a=[]
for(e in o)n=o[e],n.setIcon({path:google.maps.SymbolPath.CIRCLE,scale:5,strokeWeight:2,fillOpacity:.5,fillColor:"rgb(200,200,200)"}),n.set("selected",!1),i.listeners[t][e].remove(),a.push(i.listeners[t][e]=n.addListener("click",function(){var e
return e=this.get("dataLoggerId"),i.plotter.addStation(t,e)}))
return a},t.prototype.updateStationMap=function(t){var i,e,n,o,a,s
return i=this,this.resetStationMap(t),s=function(t,e,n){return i.markers[t][e].setIcon({path:google.maps.SymbolPath.CIRCLE,scale:7,strokeWeight:2,fillOpacity:.8,fillColor:n}),i.markers[t][e].set("selected",!0),i.listeners[t][e].remove(),i.listeners[t][e]=i.markers[t][e].addListener("click",function(){var e
return e=this.get("dataLoggerId"),i.plotter.removeStation(t,e)})},o=this.plotter.template[t].proto.options,null!==o.y.variable&&(n=o.y.variable.replace("_","-"),a="map-plot-"+t+"-station-"+o.y.dataLoggerId,e=o.y.color,s(t,a,e)),null!==o.y2.variable&&(n=o.y2.variable.replace("_","-"),a="map-plot-"+t+"-station-"+o.y2.dataLoggerId,e=o.y2.color,s(t,a,e)),null!==o.y3.variable&&(n=o.y3.variable.replace("_","-"),a="map-plot-"+t+"-station-"+o.y3.dataLoggerId,e=o.y3.color,s(t,a,e)),this.boundOnSelected(t)},t.prototype.boundOnSelected=function(t){var i,e,n,o,a,s,r,l,p,d
i=this,n=new google.maps.LatLngBounds,e=[],d=this.markers[t]
for(o in d)a=d[o],r=a.get("selected"),r===!0&&e.push(a.getPosition())
for(l=0,p=e.length;l<p;l++)s=e[l],n.extend(s)
if(this.maps[t].fitBounds(n),this.maps[t].getZoom()<6)return this.maps[t].setZoom(6)},t.prototype.toggleMap=function(t){var i,e,n,o,a
return i=128,e=256,i=0,e=0,n=this.plotter.controls.maps[t].getCenter(),a=this.plotter.controls.maps[t].getZoom(),o=$("#map-control-"+t).parent().parent().prev().offset(),$("#map-control-"+t).parent().parent().toggle().css("left",o.left-356-i).css("top",o.top-e),google.maps.event.trigger(this.plotter.controls.maps[t],"resize"),this.plotter.controls.maps[t].setCenter(n),this.plotter.controls.maps[t].setZoom(a)},t.prototype.toggle=function(t){return $(t).toggle()},t.prototype.move=function(t,i,e){var n,o
return n=this,o='<i id="move-'+t+"-"+e+'" style="cursor: pointer;" class="icon-arrow-'+e+'"></i>',$(i).append(o),$("#move-"+t+"-"+e).on("click",function(){return n.plotter.move(t,e)})},t.prototype.remove=function(t,i){var e,n
return e=this,n='<i id="remove-'+t+'" style="cursor: pointer;" class="icon-remove"></i>',$(i).append(n),$("#remove-"+t).on("click",function(){return e.plotter.remove(t)})},t.prototype.new=function(t){var i,e,n,o
return i=this,o=this.uuid(),e='<ul id="new-'+o+'-dropdown" class="dropdown-menu pull-right" role="menu" aria-labelledby="new-'+o+'"> <li><a id="new-'+o+'-parameter" style="cursor: pointer">Add Parameter Plot</a></li> <li><a id="new-'+o+'-station" style="cursor: pointer">Add Station Plot</a></li> </ul>',n='<div class="dropdown"> <li><a id="new-'+o+'" role="button" href="#"> <i class="icon-plus"></i> </a></li> </div>',$(t).append(n),$("#new-"+o).on("click",function(){return i.plotter.add("parameter")})},t.prototype.__lcname=function(t){return t.replace(" ","_").toLowerCase()},t.prototype.uuid=function(){return(4294967296*(1+Math.random())|0).toString(16).substring(1)},t.prototype.isCurrent=function(t,i,e){var n,o
for(n in t)if(o=t[n],o[i]===e)return o
return!1},t.prototype.bindSubMenuEvent=function(t){return $(t).unbind().on("click",function(t){var i
return t.preventDefault(),t.stopPropagation(),i=$(this).next(),i.is(":visible")?($(this).find("i").removeClass("icon-caret-up").addClass("icon-caret-down"),i.slideUp()):($(this).find("i").removeClass("icon-caret-down").addClass("icon-caret-up"),i.slideDown())})},t}()}.call(this),function(){var t,i=[].indexOf||function(t){for(var i=0,e=this.length;i<e;i++)if(i in this&&this[i]===t)return i
return-1}
window.Plotting||(window.Plotting={}),window.Plotting.Data=t=function(){function t(t){var i
return this.preError="Plotting.Data.",i=this.preError+".constructor(...)",t instanceof Array?(this.data=$.extend(!0,[],t),this.sourceCount=1,void(this.test=function(t,e,n){var o,a,s,r,l,p
for(i=this.preError+"test(...):",a=n.length,o=0,l=!1,s=0,r=n.length;s<r;s++){if(p=n[s],void 0===t[p])throw new Error(i+" key '"+p+"' not found in primary data set.")
if(void 0===e[p])throw new Error(i+" key '"+p+"' not found in joining data set.")
t[p]instanceof Date?t[p].getTime()===e[p].getTime()&&o++:t[p]===e[p]&&o++}return o===a&&(l=!0),l})):void console.log(i+" data not of type array.")}return t.prototype.join=function(t,e){var n,o,a,s,r,l,p,d,h,u,c,m,f,y,g
f=this.preError+".join(data, onKeys)",y=[],s="_"+parseInt(this.sourceCount+1),l=Object.keys(this.data[0]),n=Object.keys(t[0]),t.length>this.data.length?(r=$.extend(!0,[],t),d=$.extend(!0,[],this.data)):(r=$.extend(!0,[],this.data),d=$.extend(!0,[],t))
for(m in r){g=r[m],a=y.push($.extend(!0,{},g))
for(o in d)if(p=d[o],u=this.test(g,p,e)){for(h in p)c=p[h],i.call(e,h)<0&&(y[a-1][h+s]=c)
d.splice(o,1)
break}}return this.sourceCount++,this.data=this._clean(y),this.data},t.prototype.merge=function(t,e){var n,o,a,s,r,l,p,d,h,u,c,m,f,y
m=this.preError+".merge(data, onKeys)",f=[],r=Object.keys(this.data[0]),n=Object.keys(t[0]),t.length>this.data.length?(s=$.extend(!0,[],t),p=$.extend(!0,[],this.data)):(s=$.extend(!0,[],this.data),p=$.extend(!0,[],t))
for(c in s){y=s[c],a=f.push($.extend(!0,{},y))
for(o in p)if(l=p[o],h=this.test(y,l,e)){for(d in l)u=l[d],i.call(e,d)<0&&(f[a-1][d]=u)
p.splice(o,1)
break}}return this.data=this._clean(f),this.data},t.prototype.append=function(t,e){var n,o,a,s,r,l,p,d,h,u,c
h=this.preError+".append(data, onKeys)",o=$.extend(!0,[],this.data),s=$.extend(!0,[],t)
for(d in o){c=o[d]
for(n in s)if(a=s[n],l=this.test(c,a,e)){for(r in a)p=a[r],i.call(e,r)<0&&(o[d][r]=p)
s.splice(n,1)}}return u=o.concat(s),this.data=this._clean(u),this.data},t.prototype.appendKeys=function(t,i){var e,n,o
n=[]
for(e in t)o=t[e],n[e+i]=o
return this._clean(n)},t.prototype.sub=function(t,i){return this.data=this._clean($.extend(!0,[],this.data.slice(t,i))),this.data},t.prototype.get=function(){return $.extend(!0,[],this.data)},t.prototype.getSourceCount=function(){return this.sourceCount},t.prototype._clean=function(t){var i,e,n,o,a
for(i=$.extend(!0,[],t),e=i.length-1,n=o=0,a=e;0<=a?o<=a:o>=a;n=0<=a?++o:--o)void 0===i[n]&&i.splice(n,1)
return $.extend(!0,[],i)},t.prototype._tryError=function(t,i){var e,n,o,a,s
for(e=t.length-1,s=[],n=o=0,a=e;0<=a?o<=a:o>=a;n=0<=a?++o:--o){if(void 0===t[n])throw console.log("@data[i] is (i, row)",n,row),new Error(i+" undefined row")
s.push(void 0)}return s},t}()}.call(this),function(){Object.mergeDefaults||(Object.mergeDefaults=function(t,i){var e,n,o,a,s
o={}
for(e in i)a=i[e],o[e]=a
for(n in t)s=t[n],o[n]=s
return o})}.call(this),function(){var t,i=[].slice
window.Plotting||(window.Plotting={}),window.Plotting.LinePlot=t=function(){function t(t,e,n){var o,a
this.preError="LinePlot.",this.plotter=t,this.initialized=!1,this.defaults={plotId:null,uuid:"",debug:!0,target:null,dataParams:null,merge:!1,x:{variable:null,format:"%Y-%m-%dT%H:%M:%SZ",min:null,max:null,ticks:7},y:{dataLoggerId:null,variable:null,ticks:5,min:null,max:null,maxBarValue:null,color:"rgb(41, 128, 185)"},yBand:{minVariable:null,maxVariable:null},y2:{dataLoggerId:null,variable:null,ticks:5,min:null,max:null,color:"rgb(39, 174, 96)"},y2Band:{minVariable:null,maxVariable:null},y3:{dataLoggerId:null,variable:null,ticks:5,min:null,max:null,color:"rgb(142, 68, 173)"},y3Band:{minVariable:null,maxVariable:null},zoom:{scale:{min:.05,max:5}},aspectDivisor:5,transitionDuration:500,weight:2,axisColor:"rgb(0,0,0)",font:{weight:100,size:12},crosshairX:{weight:1,color:"rgb(149,165,166)"},requestInterval:{data:336}},n.x&&(n.x=Object.mergeDefaults(n.x,this.defaults.x)),n.y&&(n.y=Object.mergeDefaults(n.y,this.defaults.y)),n.y2&&(n.y2=Object.mergeDefaults(n.y2,this.defaults.y2)),n.y3&&(n.y3=Object.mergeDefaults(n.y3,this.defaults.y3)),this.options=Object.mergeDefaults(n,this.defaults),this.device="full",this.links=[{variable:"battery_voltage",title:"Battery Voltage"},{variable:"temperature",title:"Temperature"},{variable:"relative_humidity",title:"Relative Humidity"},{variable:"precitation",title:"Precipitation"},{variable:"snow_depth",title:"Snow Depth"},{variable:"wind_direction",title:"Wind Direction"},{variable:"wind_speed_average",title:"Wind Speed"},{variable:"net_solar",title:"Net Solar"},{variable:"solar_pyranometer",title:"Solar Pyranometer"},{variable:"equip_temperature",title:"Equipment Temperature"},{variable:"barometric_pressure",title:"Barometric Pressure"},{variable:"snowfall_24_hour",title:"24-Hr Snowfall"},{variable:"intermittent_snow",title:"Intermittent Snow"}],this.log=function(){var t
t=1<=arguments.length?i.call(arguments,0):[]},this.options.debug&&(this.log=function(){var t
return t=1<=arguments.length?i.call(arguments,0):[],console.log(t)}),this.parseDate=d3.timeParse(this.options.x.format),this.bisectDate=d3.bisector(function(t){return t.x}).left,this.sortDatetimeAsc=function(t,i){return t.x-i.x},this.data=this.processData(e),this.getDefinition(),a=null,o=null,e.length>0&&(a=this.getDomainScale(this.definition.x),o=this.getDomainMean(this.definition.x)),this.state={range:{data:null,scale:a},length:{data:null},interval:{data:null},zoom:1,request:{data:null},requested:{data:{min:!1,max:!1}},mean:{scale:o}},e.length>0&&(this.setDataState(),this.setIntervalState(),this.setDataRequirement())}return t.prototype.processData=function(t){var i,e,n,o
n=[]
for(e in t)o=t[e],n[e]={x:new Date(this.parseDate(o[this.options.x.variable]).getTime()-288e5),y:o[this.options.y.variable]},null!==this.options.y2.variable&&(this.options.y.variable===this.options.y2.variable?n[e].y2=o[this.options.y2.variable+"_2"]:n[e].y2=o[this.options.y2.variable]),null!==this.options.y3.variable&&(this.options.y.variable===this.options.y3.variable||this.options.y2.variable===this.options.y3.variable?n[e].y3=o[this.options.y3.variable+"_3"]:n[e].y3=o[this.options.y3.variable]),null!==this.options.yBand.minVariable&&null!==this.options.yBand.maxVariable&&(n[e].yMin=o[this.options.yBand.minVariable],n[e].yMax=o[this.options.yBand.maxVariable]),null!==this.options.y2Band.minVariable&&null!==this.options.y2Band.maxVariable&&(n[e].y2Min=o[this.options.y2Band.minVariable],n[e].y2Max=o[this.options.y2Band.maxVariable]),null!==this.options.y3Band.minVariable&&null!==this.options.y3Band.maxVariable&&(n[e].y3Min=o[this.options.y3Band.minVariable],n[e].y3Max=o[this.options.y3Band.maxVariable])
return i=new Plotting.Data(n),n=i._clean(i.get()),n.sort(this.sortDatetimeAsc)},t.prototype.setData=function(t){var i,e
if(this.data=this.processData(t),this.getDefinition(),e=null,i=null,t.length>0&&(e=this.getDomainScale(this.definition.x),i=this.getDomainMean(this.definition.x)),this.state.range.scale=e,this.state.mean.scale=i,t.length>0)return this.setDataState(),this.setIntervalState(),this.setDataRequirement()},t.prototype.appendData=function(t){var i,e
if(i=this.processData(t),e=new Plotting.Data(this.data),e.append(i,["x"]),this.data=e._clean(e.get()),this.data=this.data.sort(this.sortDatetimeAsc),this.initialized)return this.setDataState(),this.setIntervalState(),this.setDataRequirement()},t.prototype.removeData=function(t){var i,e,n,o,a
a=[],o=this.data
for(e in o)n=o[e],delete n[t],delete n[t+"Min"],delete n[t+"Max"],a[e]=n
if(i=new Plotting.Data(a),this.data=i.get(),this.data=this.data.sort(this.sortDatetimeAsc),this.initialized)return this.setDataState(),this.setIntervalState(),this.setDataRequirement()},t.prototype.setDataState=function(){var t,i,e,n
for(t=this.data.length-1,i=e=0,n=t;0<=n?e<=n:e>=n;i=0<=n?++e:--e)void 0===this.data[i]&&console.log("data[i] is (i, row)",i,this.data[i])
return this.state.range.data={min:d3.min(this.data,function(t){return t.x}),max:d3.max(this.data,function(t){return t.x})},this.state.length.data=this.data.length},t.prototype.setIntervalState=function(){return this.state.interval.data={min:(this.state.range.scale.min.getTime()-this.state.range.data.min.getTime())/36e5,max:(this.state.range.data.max.getTime()-this.state.range.scale.max.getTime())/36e5}},t.prototype.setDataRequirement=function(){var t,i
return i=new Date,t=!1,this.state.range.data.max<i&&(t=this.state.interval.data.max<this.options.requestInterval.data),this.state.request.data={min:this.state.interval.data.min<this.options.requestInterval.data,max:t}},t.prototype.setZoomState=function(t){return this.state.zoom=t},t.prototype.getDomainScale=function(t){var i
return i={min:t.domain()[0],max:t.domain()[1]}},t.prototype.getDomainMean=function(t){var i
return i=new Date(d3.mean(t.domain())),i.setHours(i.getHours()+Math.round(i.getMinutes()/60)),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),i},t.prototype.getDefinition=function(){var t,i,e
return e=this.preError+"getDefinition():",t=this,this.definition={colorScale:d3.schemeCategory20},this.calculateChartDims(),this.calculateAxisDims(this.data),this.definition.xAxis=d3.axisBottom().scale(this.definition.x).ticks(Math.round($(this.options.target).width()/100)),this.definition.yAxis=d3.axisLeft().scale(this.definition.y).ticks(this.options.y.ticks),this.definition.x.domain([this.definition.x.min,this.definition.x.max]),this.definition.y.domain([this.definition.y.min,this.definition.y.max]).nice(),i=[[-(1/0),0],[this.definition.x(new Date),this.definition.dimensions.innerHeight]],this.definition.zoom=d3.zoom().scaleExtent([this.options.zoom.scale.min,this.options.zoom.scale.max]).translateExtent(i).on("zoom",function(){var i
return i=t.setZoomTransform(),t.plotter.zoom(i)}),this.definition.line=d3.line().defined(function(t){return!isNaN(t.y)&&null!==t.y}).x(function(i){return t.definition.x(i.x)}).y(function(i){return t.definition.y(i.y)}),this.definition.line2=d3.line().defined(function(t){return!isNaN(t.y2)&&null!==t.y2}).x(function(i){return t.definition.x(i.x)}).y(function(i){return t.definition.y(i.y2)}),this.definition.line3=d3.line().defined(function(t){return!isNaN(t.y3)&&null!==t.y3}).x(function(i){return t.definition.x(i.x)}).y(function(i){return t.definition.y(i.y3)}),this.definition.area=d3.area().defined(function(t){return!isNaN(t.yMin)&&null!==t.yMin&&!isNaN(t.yMax)&&null!==t.yMax}).x(function(i){return t.definition.x(i.x)}).y0(function(i){return t.definition.y(i.yMin)}).y1(function(i){return t.definition.y(i.yMax)}),this.definition.area2=d3.area().defined(function(t){return!isNaN(t.y2Min)&&null!==t.y2Min&&!isNaN(t.y2Max)&&null!==t.y2Max}).x(function(i){return t.definition.x(i.x)}).y0(function(i){return t.definition.y(i.y2Min)}).y1(function(i){return t.definition.y(i.y2Max)}),this.definition.area3=d3.area().defined(function(t){return!isNaN(t.y3Min)&&null!==t.y3Min&&!isNaN(t.y3Max)&&null!==t.y3Max}).x(function(i){return t.definition.x(i.x)}).y0(function(i){return t.definition.y(i.y3Min)}).y1(function(i){return t.definition.y(i.y3Max)})},t.prototype.calculateChartDims=function(){var t,i,e
return e=Math.round($(this.options.target).width())-24,t=Math.round(e/this.options.aspectDivisor),e>1e3?i={top:Math.round(.04*t),right:Math.round(Math.pow(e,.3)),bottom:Math.round(.12*t),left:Math.round(Math.pow(e,.6))}:e>600?(this.device="mid",this.options.font.size=this.options.font.size/1.25,t=Math.round(e/(this.options.aspectDivisor/1.25)),i={top:Math.round(.04*t),right:Math.round(Math.pow(e,.3)),bottom:Math.round(.14*t),left:Math.round(Math.pow(e,.6))}):(this.device="small",this.options.font.size=this.options.font.size/1.5,t=Math.round(e/(this.options.aspectDivisor/1.5)),i={top:Math.round(.04*t),right:Math.round(Math.pow(e,.3)),bottom:Math.round(.18*t),left:Math.round(Math.pow(e,.6))}),this.definition.dimensions={width:e,height:t,margin:i},this.definition.dimensions.topPadding=parseInt(this.definition.dimensions.margin.top),this.definition.dimensions.bottomPadding=parseInt(this.definition.dimensions.height-this.definition.dimensions.margin.bottom),this.definition.dimensions.leftPadding=parseInt(this.definition.dimensions.margin.left),this.definition.dimensions.innerHeight=parseInt(this.definition.dimensions.height-this.definition.dimensions.margin.bottom-this.definition.dimensions.margin.top),this.definition.dimensions.innerWidth=parseInt(this.definition.dimensions.width-this.definition.dimensions.margin.left-this.definition.dimensions.margin.right),this.definition.x=d3.scaleTime().range([i.left,e-i.right]),this.definition.y=d3.scaleLinear().range([t-i.bottom,i.top])},t.prototype.calculateAxisDims=function(t){return this.calculateXAxisDims(t),this.calculateYAxisDims(t)},t.prototype.calculateXAxisDims=function(t){return this.definition.x.min=null===this.options.x.min?d3.min(t,function(t){return t.x}):this.parseDate(this.options.x.min),this.definition.x.max=null===this.options.x.max?d3.max(t,function(t){return t.x}):this.parseDate(this.options.x.max)},t.prototype.calculateYAxisDims=function(t){return this.definition.y.min=d3.min([d3.min(t,function(t){return t.y}),d3.min(t,function(t){return t.y2}),d3.min(t,function(t){return t.y2}),d3.min(t,function(t){return t.yMin}),d3.min(t,function(t){return t.y2Min}),d3.min(t,function(t){return t.y3Min})]),this.definition.y.max=d3.max([d3.max(t,function(t){return t.y}),d3.max(t,function(t){return t.y2}),d3.max(t,function(t){return t.y3}),d3.max(t,function(t){return t.yMax}),d3.max(t,function(t){return t.y2Max}),d3.max(t,function(t){return t.y3Max})]),this.definition.y.min===this.definition.y.max&&(this.definition.y.min=.8*this.definition.y.min,this.definition.y.max=1.2*this.definition.y.min),this.definition.y.min=null===this.options.y.min?this.definition.y.min:this.options.y.min,this.definition.y.max=null===this.options.y.max?this.definition.y.max:this.options.y.max},t.prototype.preAppend=function(){var t,i,e,n,o
return n=this.preError+"preAppend()",t=this,this.outer=d3.select(this.options.target).append("div").attr("class","line-plot-body").style("width",this.definition.dimensions.width+"px").style("height",this.definition.dimensions.height+"px").style("display","inline-block"),this.ctls=d3.select(this.options.target).append("div").attr("class","line-plot-controls").style("width","23px").style("height",this.definition.dimensions.height+"px").style("display","inline-block").style("vertical-align","top"),0===this.data.length&&("station"===this.options.type?(e="Select the Plot's Station",o="Station type plots allow comparison of different variables from the same station."):"parameter"===this.options.type&&(e="Select the Plot's Parameter",o="Parameter type plots allow comparison of a single paramater at multiple stations"),i=$(this.options.target).offset(),this.temp=this.outer.append("div").attr("class","new-temp-"+this.options.plotId).style("position","absolute").style("top",parseInt(i.top+this.definition.dimensions.innerHeight/2-18)+"px").style("left",parseInt(i.left+this.definition.dimensions.margin.left)+"px").style("width",this.definition.dimensions.innerWidth+"px").style("text-align","center"),this.dropdown=this.temp.append("div").attr("class","dropdown"),this.dropdown.append("a").text(e).attr("class","dropdown-toggle").attr("data-toggle","dropdown"),this.dropdown.append("ul").attr("class","dropdown-menu").selectAll("li").data(t.links).enter().append("li").append("a").text(function(t){return t.title}).on("click",function(i){return t.plotter.initVariable(t.options.plotId,i.variable,i.title)}),this.temp.append("p").text(o).style("color","#ggg").style("font-size","12px")),this.svg=this.outer.append("svg").attr("class","line-plot").attr("width",this.definition.dimensions.width).attr("height",this.definition.dimensions.height),this.svg.append("defs").append("clipPath").attr("id",this.options.target+"_clip").append("rect").attr("width",this.definition.dimensions.innerWidth).attr("height",this.definition.dimensions.innerHeight).attr("transform","translate("+this.definition.dimensions.leftPadding+", "+this.definition.dimensions.topPadding+")"),this.svg.append("g").attr("class","line-plot-axis-x").style("fill","none").style("stroke",this.options.axisColor).style("font-size",this.options.font.size).style("font-weight",this.options.font.weight).call(this.definition.xAxis).attr("transform","translate(0, "+this.definition.dimensions.bottomPadding+")"),this.svg.append("g").attr("class","line-plot-axis-y").style("fill","none").style("stroke",this.options.axisColor).style("font-size",this.options.font.size).style("font-weight",this.options.font.weight).call(this.definition.yAxis).attr("transform","translate("+this.definition.dimensions.leftPadding+", 0)")},t.prototype.append=function(){var t,i,e,n,o,a,s
if(this.initialized=!0,this.initialized)return s=this.preError+"append()",t=this,o=""+this.options.y.title,this.options.y.units&&(o=o+" "+this.options.y.units),a=-15,n=-52,"small"===this.device&&(a=-10,n=-30),this.svg.select(".line-plot-axis-y").append("text").text(o).attr("class","line-plot-y-label").attr("x",a).attr("y",n).attr("dy",".75em").attr("transform","rotate(-90)").style("font-size",this.options.font.size).style("font-weight",this.options.font.weight),this.options.y2.title&&(i=i+" "+this.options.y2.title),this.options.y3.units&&(e=e+" "+this.options.y3.units),this.lineband=this.svg.append("g").attr("clip-path","url(#"+this.options.target+"_clip)").append("path").datum(this.data).attr("d",this.definition.area).attr("class","line-plot-area").style("fill",this.options.y.color).style("opacity",.15).style("stroke",function(){return d3.color(t.options.y.color).darker(1)}),this.lineband2=this.svg.append("g").attr("clip-path","url(#"+this.options.target+"_clip)").append("path").datum(this.data).attr("d",this.definition.area2).attr("class","line-plot-area2").style("fill",this.options.y2.color).style("opacity",.25).style("stroke",function(){return d3.rgb(t.options.y2.color).darker(1)}),this.lineband3=this.svg.append("g").attr("clip-path","url(#"+this.options.target+"_clip)").append("path").datum(this.data).attr("d",this.definition.area3).attr("class","line-plot-area3").style("fill",this.options.y3.color).style("opacity",.25).style("stroke",function(){return d3.rgb(t.options.y3.color).darker(1)}),this.svg.append("g").attr("clip-path","url(#"+this.options.target+"_clip)").append("path").datum(this.data).attr("d",this.definition.line).attr("class","line-plot-path").style("stroke",this.options.y.color).style("stroke-width",Math.round(Math.pow(this.definition.dimensions.width,.1))).style("fill","none"),this.svg.append("g").attr("clip-path","url(#"+this.options.target+"_clip)").append("path").datum(this.data).attr("d",this.definition.line2).attr("class","line-plot-path2").style("stroke",this.options.y2.color).style("stroke-width",Math.round(Math.pow(this.definition.dimensions.width,.1))).style("fill","none"),this.svg.append("g").attr("clip-path","url(#"+this.options.target+"_clip)").append("path").datum(this.data).attr("d",this.definition.line3).attr("class","line-plot-path3").style("stroke",this.options.y3.color).style("stroke-width",Math.round(Math.pow(this.definition.dimensions.width,.1))).style("fill","none"),null!==this.options.y.maxBarValue&&this.svg.append("rect").attr("class","line-plot-max-bar").attr("x",this.definition.dimensions.leftPadding).attr("y",this.definition.y(32)).attr("width",this.definition.dimensions.innerWidth).attr("height",1).style("color","#gggggg").style("opacity",.4),this.crosshairs=this.svg.append("g").attr("class","crosshair"),this.crosshairs.append("line").attr("class","crosshair-x").style("stroke",this.options.crosshairX.color).style("stroke-width",this.options.crosshairX.weight).style("stroke-dasharray","3, 3").style("fill","none"),this.crosshairs.append("rect").attr("class","crosshair-x-under").style("fill","rgb(255,255,255)").style("opacity",.1),this.focusCircle=this.svg.append("circle").attr("r",4).attr("id","focus-circle-1").attr("class","focus-circle").attr("fill",this.options.y.color).attr("transform","translate(-10, -10)").style("display","none"),this.focusText=this.svg.append("text").attr("id","focus-text-1").attr("class","focus-text").attr("x",9).attr("y",7).style("display","none").style("fill",this.options.y.color).style("text-shadow","-2px -2px 0 rgb(255,255,255), 2px -2px 0 rgb(255,255,255), -2px 2px 0 rgb(255,255,255), 2px 2px 0 rgb(255,255,255)"),this.focusCircle2=this.svg.append("circle").attr("r",4).attr("id","focus-circle-2").attr("class","focus-circle").attr("fill",this.options.y2.color).attr("transform","translate(-10, -10)").style("display","none"),this.focusText2=this.svg.append("text").attr("id","focus-text-2").attr("class","focus-text").attr("x",9).attr("y",7).style("display","none").style("fill",this.options.y2.color).style("text-shadow","-2px -2px 0 rgb(255,255,255), 2px -2px 0 rgb(255,255,255), -2px 2px 0 rgb(255,255,255), 2px 2px 0 rgb(255,255,255)"),this.focusCircle3=this.svg.append("circle").attr("r",4).attr("id","focus-circle-3").attr("class","focus-circle").attr("fill",this.options.y3.color).attr("transform","translate(-10, -10)").style("display","none"),this.focusText3=this.svg.append("text").attr("id","focus-text-3").attr("class","focus-text").attr("x",9).attr("y",7).style("display","none").style("fill",this.options.y3.color).style("text-shadow","-2px -2px 0 rgb(255,255,255), 2px -2px 0 rgb(255,255,255), -2px 2px 0 rgb(255,255,255), 2px 2px 0 rgb(255,255,255)"),this.overlay=this.svg.append("rect").attr("class","plot-event-target"),this.appendCrosshairTarget(),this.appendZoomTarget()},t.prototype.update=function(){var t,i
return i=this.preError+"update()",t=this,this.svg.select(".line-plot-area").datum(this.data).attr("d",this.definition.area).style("fill",this.options.y.color).style("stroke",function(){return d3.rgb(t.options.y.color).darker(1)}),this.svg.select(".line-plot-area2").datum(this.data).attr("d",this.definition.area2).style("fill",this.options.y2.color).style("stroke",function(){return d3.rgb(t.options.y2.color).darker(1)}),this.svg.select(".line-plot-area3").datum(this.data).attr("d",this.definition.area3).style("fill",this.options.y3.color).style("stroke",function(){return d3.rgb(t.options.y3.color).darker(1)}),this.svg.select(".line-plot-path").datum(this.data).attr("d",this.definition.line).style("stroke",this.options.y.color).style("stroke-width",Math.round(Math.pow(this.definition.dimensions.width,.1))).style("fill","none"),this.svg.select(".line-plot-path2").datum(this.data).attr("d",this.definition.line2).style("stroke",this.options.y2.color).style("stroke-width",Math.round(Math.pow(this.definition.dimensions.width,.1))).style("fill","none"),this.svg.select(".line-plot-path3").datum(this.data).attr("d",this.definition.line3).style("stroke",this.options.y3.color).style("stroke-width",Math.round(Math.pow(this.definition.dimensions.width,.1))).style("fill","none"),this.overlay.datum(this.data),this.calculateYAxisDims(this.data),this.definition.y.domain([this.definition.y.min,this.definition.y.max]).nice(),this.svg.select(".line-plot-area").datum(this.data).attr("d",this.definition.area),this.svg.select(".line-plot-area2").datum(this.data).attr("d",this.definition.area2),this.svg.select(".line-plot-area3").datum(this.data).attr("d",this.definition.area3),this.svg.select(".line-plot-path").datum(this.data).attr("d",this.definition.line),this.svg.select(".line-plot-path2").datum(this.data).attr("d",this.definition.line2),this.svg.select(".line-plot-path3").datum(this.data).attr("d",this.definition.line3),this.svg.select(".line-plot-axis-y").call(this.definition.yAxis)},t.prototype.removeTemp=function(){return this.temp.remove()},t.prototype.appendCrosshairTarget=function(t){var i,e
if(this.initialized)return e=this.preError+"appendCrosshairTarget()",i=this,this.overlay.datum(this.data).attr("class","overlay").attr("width",this.definition.dimensions.innerWidth).attr("height",this.definition.dimensions.innerHeight).attr("transform","translate("+this.definition.dimensions.leftPadding+", "+this.definition.dimensions.topPadding+")").style("fill","none").style("pointer-events","all").on("mouseover",function(){return i.plotter.showCrosshairs()}).on("mouseout",function(){return i.plotter.hideCrosshairs()}).on("mousemove",function(){var e
return e=i.setCrosshair(t),i.plotter.crosshair(t,e)})},t.prototype.appendZoomTarget=function(){var t,i
if(this.initialized)return i=this.preError+"appendZoomTarget()",t=this,this.overlay.attr("class","zoom-pane").attr("width",this.definition.dimensions.innerWidth).attr("height",this.definition.dimensions.innerHeight).attr("transform","translate("+this.definition.dimensions.leftPadding+", "+this.definition.dimensions.topPadding+")").style("fill","none").style("pointer-events","all").style("cursor","move").call(this.definition.zoom,d3.zoomIdentity)},t.prototype.setZoomTransform=function(t){var i,e,n,o
if(this.initialized)return o=this.preError+".setZoomTransform(transform)",i=this,n=t?t:d3.event.transform,e=n.rescaleX(this.definition.x),this.svg.select(".line-plot-axis-x").call(this.definition.xAxis.scale(e)),this.state.range.scale=this.getDomainScale(e),this.state.mean.scale=this.getDomainMean(e),this.setDataState(),this.setIntervalState(),this.setDataRequirement(),this.setZoomState(n.k),this.definition.area=d3.area().defined(function(t){return!isNaN(t.yMin)&&null!==t.yMin&&!isNaN(t.yMax)&&null!==t.yMax}).x(function(t){return n.applyX(i.definition.x(t.x))}).y0(function(t){return i.definition.y(t.yMin)}).y1(function(t){return i.definition.y(t.yMax)}),this.svg.select(".line-plot-area").attr("d",this.definition.area),this.definition.line=d3.line().defined(function(t){return!isNaN(t.y)&&null!==t.y}).x(function(t){return n.applyX(i.definition.x(t.x))}).y(function(t){return i.definition.y(t.y)}),this.svg.select(".line-plot-path").attr("d",this.definition.line),this.definition.area2=d3.area().defined(function(t){return!isNaN(t.y2Min)&&null!==t.y2Min&&!isNaN(t.y2Max)&&null!==t.y2Max}).x(function(t){return n.applyX(i.definition.x(t.x))}).y0(function(t){return i.definition.y(t.y2Min)}).y1(function(t){return i.definition.y(t.y2Max)}),this.svg.select(".line-plot-area2").attr("d",this.definition.area2),this.definition.line2=d3.line().defined(function(t){return!isNaN(t.y2)&&null!==t.y2}).x(function(t){return n.applyX(i.definition.x(t.x))}).y(function(t){return i.definition.y(t.y2)}),this.svg.select(".line-plot-path2").attr("d",this.definition.line2),this.definition.area3=d3.area().defined(function(t){return!isNaN(t.y3Min)&&null!==t.y3Min&&!isNaN(t.y3Max)&&null!==t.y3Max}).x(function(t){return n.applyX(i.definition.x(t.x))}).y0(function(t){return i.definition.y(t.y3Min)}).y1(function(t){return i.definition.y(t.y3Max)}),this.svg.select(".line-plot-area3").attr("d",this.definition.area3),this.definition.line3=d3.line().defined(function(t){return!isNaN(t.y3)&&null!==t.y3}).x(function(t){return n.applyX(i.definition.x(t.x))}).y(function(t){return i.definition.y(t.y3)}),this.svg.select(".line-plot-path3").attr("d",this.definition.line3),this.appendCrosshairTarget(n),n},t.prototype.setCrosshair=function(t,i){var e,n,o,a,s,r,l,p,d,h,u,c,m,f
if(this.initialized)return c=this.preError+".setCrosshair(mouse)",e=this,o=this.definition.dimensions,a=this.overlay.node(),n=this.overlay.datum(),i=i?i:d3.mouse(a),m=this.definition.x.invert(i[0]+o.leftPadding),t&&(m=this.definition.x.invert(t.invertX(i[0]+o.leftPadding))),u=e.bisectDate(n,m,1),r=m.getMinutes()>=30?n[u]:n[u-1],m.getTime()<this.state.range.data.min.getTime()&&(r=n[u-1]),m.getTime()>this.state.range.data.max.getTime()&&(r=n[u-1]),l=t?t.applyX(this.definition.x(r.x)):this.definition.x(r.x),null!==this.options.y.variable&&(p=this.definition.y(r.y),isNaN(p)||this.focusCircle.attr("transform","translate(0, 0)")),null!==this.options.y2.variable&&(d=this.definition.y(r.y2),isNaN(d)||this.focusCircle2.attr("transform","translate(0, 0)")),null!==this.options.y3.variable&&(h=this.definition.y(r.y3),isNaN(h)||this.focusCircle3.attr("transform","translate(0, 0)")),null!==r&&void 0!==r||console.log("d is broken (d)",r),s=l-o.leftPadding,s>=0&&(this.crosshairs.select(".crosshair-x").attr("x1",s).attr("y1",o.topPadding).attr("x2",s).attr("y2",o.innerHeight+o.topPadding).attr("transform","translate("+o.leftPadding+", 0)"),this.crosshairs.select(".crosshair-x-under").attr("x",s).attr("y",o.topPadding).attr("width",o.innerWidth-s).attr("height",o.innerHeight).attr("transform","translate("+o.leftPadding+", 0)")),null===this.options.y.variable||isNaN(p)||(this.focusCircle.attr("cx",l).attr("cy",p),this.focusText.attr("x",l+o.leftPadding/10).attr("y",p-o.topPadding/10).text(r.y?r.y.toFixed(1)+" "+this.options.y.units:void 0)),null===this.options.y2.variable||isNaN(d)||(this.focusCircle2.attr("cx",l).attr("cy",d),this.focusText2.attr("x",l+o.leftPadding/10).attr("y",d-o.topPadding/10).text(r.y2?r.y2.toFixed(1)+" "+this.options.y2.units:void 0)),null===this.options.y3.variable||isNaN(h)||(this.focusCircle3.attr("cx",l).attr("cy",h),this.focusText3.attr("x",l+o.leftPadding/10).attr("y",h-o.topPadding/10).text(r.y3?r.y3.toFixed(1)+" "+this.options.y3.units:void 0)),null!==this.options.y.variable&&null!==this.options.y2.variable&&null!==this.options.y3.variable&&(f=[],this.svg.selectAll(".focus-text").attr("transform",function(t,i){var e
return e={ind:i,y:parseInt(d3.select(this).attr("y")),offset:0},f.push(e),""}).call(function(t){return f.sort(function(t,i){return t.y-i.y}),f.forEach(function(t,i){var e
if(i>0)return e=Math.max(0,f[i-1].y+18-f[i].y),0===f[i].ind&&(e=-e),f[i].offset=e})}).attr("transform",function(t,i){return"translate (0, "+f[i].offset+")"})),i},t.prototype.showCrosshair=function(){if(this.initialized)return this.crosshairs.select(".crosshair-x").style("display",null),this.crosshairs.select(".crosshair-x-under").style("display",null),null!==this.options.y.variable&&(this.focusCircle.style("display",null).attr("fill",this.options.y.color),this.focusText.style("display",null).style("color",this.options.y.color).style("fill",this.options.y.color)),null!==this.options.y2.variable&&(this.focusCircle2.style("display",null).attr("fill",this.options.y2.color),this.focusText2.style("display",null).style("color",this.options.y2.color).style("fill",this.options.y2.color)),null!==this.options.y3.variable?(this.focusCircle3.style("display",null).attr("fill",this.options.y3.color),this.focusText3.style("display",null).style("color",this.options.y3.color).style("fill",this.options.y3.color)):void 0},t.prototype.hideCrosshair=function(){if(this.initialized)return this.crosshairs.select(".crosshair-x").style("display","none"),this.crosshairs.select(".crosshair-x-under").style("display","none"),null!==this.options.y.variable&&(this.focusCircle.style("display","none"),this.focusText.style("display","none")),null!==this.options.y2.variable&&(this.focusCircle2.style("display","none"),this.focusText2.style("display","none")),null!==this.options.y3.variable?(this.focusCircle3.style("display","none"),this.focusText3.style("display","none")):void 0},t.prototype.appendTitle=function(t,i){var e,n,o
if(n=1,e="16px",o="12px","small"===this.device&&(n=.4,e="10px",o="7px"),this.title=this.svg.append("g").attr("class","line-plot-title"),this.title.append("text").attr("x",this.definition.dimensions.margin.left+10).attr("y",this.definition.dimensions.margin.top/2-4*n).style("font-size",e).style("font-weight",600).text(t),i)return this.title.append("text").attr("x",this.definition.dimensions.margin.left+10).attr("y",this.definition.dimensions.margin.top/2+12*n).style("font-size",o).text(i)},t.prototype.getState=function(){return this.state},t}()}.call(this),function(){var t
window.Plotting||(window.Plotting={}),window.Plotting.Handler=t=function(){function t(t,i,e){var n,o
this.preError="Plotting.Handler",o={templateId:null,href:location.origin,target:null,dateFormat:"%Y-%m-%dT%H:%M:%SZ",refresh:500,updateLength:168,colors:{light:["rgb(53, 152, 219)","rgb(241, 196, 14)","rgb(155, 88, 181)","rgb(27, 188, 155)","rgb(52, 73, 94)","rgb(231, 126, 35)","rgb(45, 204, 112)","rgb(232, 76, 61)","rgb(149, 165, 165)"],dark:["rgb(45, 62, 80)","rgb(210, 84, 0)","rgb(39, 174, 97)","rgb(192, 57, 43)","rgb(126, 140, 141)","rgb(42, 128, 185)","rgb(239, 154, 15)","rgb(143, 68, 173)","rgb(23, 160, 134)"]}},this.options=Object.mergeDefaults(i,o),this.now=new Date,this.updates=0,"http://localhost:5000"===this.options.href&&(this.options.href="http://dev.nwac.us"),this.endpoint=null,n={token:null,expires:null,expired:!0,admin:!1},t=Object.mergeDefaults(t,n),this.api=new window.Plotting.API(t.token),this.syncronousapi=new window.Plotting.API(t.token,!1),this.controls=new window.Plotting.Controls(this,t),this.parseDate=d3.timeParse(this.options.dateFormat),this.format=d3.utcFormat(this.options.dateFormat),this.getNow=function(){return this.format(this.now)},this.isAdmin=function(){return t.admin},this.hasAccess=function(){return this.parseDate(t.expires)>new Date&&(t.expired=!0),!t.expired}}return t.prototype.initialize=function(){return this.getTemplate(),this.getTemplatePlotData(),this.append(),this.listen()},t.prototype.listen=function(){var t,i,e,n
e=this.template
for(t in e)i=e[t],i&&i.proto.initialized&&(n=i.proto.getState(),n.request.data.min&&this.updates<7&&!n.requested.min&&(this.updates++,i.proto.state.requested.min=!0,this.prependData(t)),n.request.data.max&&this.updates<7&&!n.requested.max&&(this.updates++,i.proto.state.requested.max=!0,this.appendData(t)))
return setTimeout(Plotting.Handler.prototype.listen.bind(this),this.options.refresh)},t.prototype.listenTest=function(){var t,i,e
if(t=0,i=this.template[t],e=i.proto.getState(),e.request.data.min&&this.prependData(t),e.request.data.max)return this.appendData(t)},t.prototype.listenTestLoop=function(){var t,i,e,n,o
e=this.template,n=[]
for(t in e)i=e[t],o=i.proto.getState(),o.request.data.min&&this.prependData(t),o.request.data.max?n.push(this.appendData(t)):n.push(void 0)
return n},t.prototype.getTemplate=function(t){var i,e,n,o,a
return o=this.preError+".getTemplate(...)",a=this.options.href+"/api/v5/plothandler/"+this.options.plotHandlerId,e=null,i=this,n=function(t){var e,n
if(null===t.responseJSON||t.responseJSON.error)return void console.log(o+".callback(...) error detected (data)",t)
try{e=JSON.parse(t.responseJSON.template_data),i.template=e.templateData}catch(t){n=t,console.log(o+".callback(...) JSON.parse error",n)}return i.parseDates(i.template)},this.syncronousapi.get(a,e,n)},t.prototype.parseDates=function(t){var i,e,n,o,a,s,r,l,p,d
for(i=this,s=function(t){var e,n
return t.includes("now")&&(n=new Date,t.includes("(")&&(e=parseInt(t.replace("(","").replace(")","").replace("now","")),n=new Date(n.getTime()+36e5*e)),t=i.format(n)),t},l=[],e=0,o=t.length;e<o;e++){for(p=t[e],r=p.dataParams,n=0,a=r.length;n<a;n++)d=r[n],d.max_datetime=s(d.max_datetime)
p.options.x.min=s(p.options.x.min),l.push(p.options.x.max=s(p.options.x.max))}return l},t.prototype.putTemplate=function(){var t,i,e,n,o
if(this.isAdmin()!==!1)return n=this.preError+".putTemplate()",o=this.options.href+"/api/v5/plothandler/",i={id:this.options.templateId,template_data:{templateData:this.template}},t=this,e=function(t){return null===t.responseJSON||t.responseJSON.error?void console.log(n+".callback(...) error detected (data)",t):console.log(n+".callback() successfully saved template.")},this.api.put(o,i,e)},t.prototype.getStationParamData=function(t,i){var e,n,o,a,s
return a=this.preError+".getStationParamData()",s=this.options.href+"/api/v5/measurement",e=this,n=this.template[t].dataParams[i],o=function(i){return void 0===e.template[t].data?e.template[t].data=[i.responseJSON.results]:e.template[t].data.push(i.responseJSON.results)},this.syncronousapi.get(s,n,o)},t.prototype.getTemplatePlotData=function(){var t,i,e,n,o,a,s
n=this.preError+".getPlotData()",o=this.template,a=[]
for(t in o)e=o[t],a.push(function(){var e,n
e=this.template[t].dataParams,n=[]
for(s in e)i=e[s],n.push(this.getStationParamData(t,s))
return n}.call(this))
return a},t.prototype.append=function(){var t,i,e,n,o,a,s,r,l,p,d,h,u,c
p=this.preError+".append()",t=this,d=this.template
for(r in d){if(l=d[r],u=this.utarget(this.options.target),$(this.options.target).append("<div id='"+u+"'></div>"),this.mergeTemplateOption(r),void 0===l.options.y2&&(l.options.y2={}),void 0===l.options.y3&&(l.options.y3={}),l.options.plotId=r,l.options.uuid=this.uuid(),l.options.target="#"+u,l.options.y.color=this.getColor("light",r),l.options.y2.color=this.getColor("light",parseInt(r+4)),l.options.y3.color=this.getColor("light",parseInt(r+6)),e=this.getVariableBounds(l.options.y.variable),e&&(l.options.y.min=e.min,l.options.y.max=e.max),"temperature"===l.options.y.variable&&(l.options.y.maxBarValue=32),i=new window.Plotting.Data(l.data[0]),n=l.data.length-1,n>0)for(o=s=1,h=n;1<=h?s<=h:s>=h;o=1<=h?++s:--s)i.join(l.data[o],[l.options.x.variable])
c=this.getTitle(l),a=new window.Plotting.LinePlot(this,i.get(),l.options),a.preAppend(),a.append(),this.template[r].proto=a,this.appendControls(r)}if(this.isAdmin())return $(this.options.target).append('<small><a style="cusor:pointer" id="save-'+u+'">Save Template</a></small>'),$("#save-"+u).on("click",function(i){return t.putTemplate()})},t.prototype.mergeTemplateOption=function(t){var i,e
if(e=this.template[t],e.options.dataParams=e.dataParams,i=e.options.dataParams.length,i>0&&(e.options.y.dataLoggerId=e.options.dataParams[0].data_logger),i>1&&(e.options.y2.dataLoggerId=e.options.dataParams[1].data_logger),i>2)return e.options.y2.dataLoggerId=e.options.dataParams[2].data_logger},t.prototype.getAppendData=function(t,i,e,n){var o,a,s,r,l,p
return l=this.preError+".getAppendData(key, dataParams)",p=this.options.href+"/api/v5/measurement",o=this,s=this.template[i].proto.options.dataParams[e],a=this.template[i].proto.options.dataParams.length,r=function(e){var r
if(r=o.template[i],void 0===r.__data&&(r.__data=[]),void 0===r.__data[t]?r.__data[t]=new window.Plotting.Data(e.responseJSON.results):(s.data_logger===r.options.y2.dataLoggerId?e.responseJSON.results=r.__data.appendKeys(e.responseJSON.results,"_2"):s.data_logger===r.options.y3.dataLoggerId&&(e.responseJSON.results=r.__data.appendKeys(e.responseJSON.results,"_3")),r.__data[t].join(e.responseJSON.results,[r.proto.options.x.variable])),r.__data[t].getSourceCount()===a&&(r.proto.initialized?(r.proto.appendData(r.__data[t].get()),r.proto.update()):(r.proto.setData(r.__data[t].get()),r.proto.append()),delete r.__data[t]),o.controls.removeSpinner(i),"min"===n?r.proto.state.requested.min=!1:"max"===n&&(r.proto.state.requested.max=!1),o.updates--,o.updates<0)return o.updates=0},this.api.get(p,s,r)},t.prototype.prependData=function(t){var i,e,n,o,a,s,r,l
a=this.preError+".prependData()",o=this.template[t],l=o.proto.getState(),i=this.uuid(),s=o.proto.options.dataParams,r=[]
for(n in s)e=s[n],o.proto.options.dataParams[n].max_datetime=this.format(l.range.data.min),o.proto.options.dataParams[n].limit=this.options.updateLength,r.push(this.getAppendData(i,t,n,"min"))
return r},t.prototype.appendData=function(t){var i,e,n,o,a,s,r,l,p,d,h
if(l=this.preError+".appendData()",r=this.template[t],h=r.proto.getState(),n=new Date,!(h.range.data.max>=n)){i=h.range.data.max.getTime(),e=i+36e5*this.options.updateLength,o=this.uuid(),p=r.proto.options.dataParams,d=[]
for(s in p)a=p[s],r.proto.options.dataParams[s].max_datetime=this.format(new Date(e)),r.proto.options.dataParams[s].limit=this.options.updateLength,d.push(this.getAppendData(o,t,s,"max"))
return d}},t.prototype.addVariable=function(t,i){var e,n,o,a,s,r,l
r=this.template[t].proto.getState(),e=r.range.data.max.getTime(),this.setNewOptions(t,i),l=this.uuid(),a=this.template[t].proto.options.dataParams,s=[]
for(o in a)n=a[o],this.template[t].proto.options.dataParams[o].max_datetime=this.format(new Date(e)),this.template[t].proto.options.dataParams[o].limit=r.length.data,s.push(this.getAppendData(l,t,o))
return s},t.prototype.addStation=function(t,i){var e,n,o,a,s,r,l,p,d
if(!this.template[t].proto.initialized)return this.appendNew(t,i)
if(this.template[t].proto.options.y.dataLoggerId&&this.template[t].proto.options.y2.dataLoggerId&&this.template[t].proto.options.y3.dataLoggerId)return this.controls.removeSpinner(t),null
p=this.template[t].proto.getState(),a=this.template[t].proto.options.y.variable,n=p.range.data.max.getTime(),o=$.extend(!0,{},this.template[t].proto.options.dataParams[0]),o.data_logger=i,e=this.template[t].proto.options.dataParams.push(o),this.setNewOptions(t,a,i),d=this.uuid(),l=this.template[t].proto.options.dataParams
for(r in l)s=l[r],this.template[t].proto.options.dataParams[r].max_datetime=this.format(new Date(n)),this.template[t].proto.options.dataParams[r].limit=p.length.data,this.getAppendData(d,t,r)
return this.controls.updateStationDropdown(t),this.controls.updateStationMap(t)},t.prototype.removeStation=function(t,i){var e,n,o,a
return e=null,a=this.template[t],o=this.template[t].proto,n=this.indexOfValue(a.dataParams,"data_logger",i),o.options.y.dataLoggerId===i?e="y":o.options.y2.dataLoggerId===i?e="y2":o.options.y3.dataLoggerId===i&&(e="y3"),n>-1&&(a.dataParams.splice(n,1),o.options[e]=null,o.appendData(),"y"===e&&(o.options.y=Object.mergeDefaults(o.options.y,o.defaults.y)),"y2"===e&&(o.options.y2=Object.mergeDefaults(o.options.y2,o.defaults.y2)),"y3"===e&&(o.options.y3=Object.mergeDefaults(o.options.y3,o.defaults.y3)),o.getDefinition(),o.removeData(e),o.update()),this.controls.removeSpinner(t),this.controls.updateStationDropdown(t),this.controls.updateStationMap(t)},t.prototype.zoom=function(t){var i,e,n,o,a
for(o=this.template,a=[],i=0,e=o.length;i<e;i++)n=o[i],n?a.push(n.proto.setZoomTransform(t)):a.push(void 0)
return a},t.prototype.crosshair=function(t,i){var e,n,o,a,s
for(a=this.template,s=[],e=0,n=a.length;e<n;e++)o=a[e],o?s.push(o.proto.setCrosshair(t,i)):s.push(void 0)
return s},t.prototype.showCrosshairs=function(){var t,i,e,n,o
for(n=this.template,o=[],t=0,i=n.length;t<i;t++)e=n[t],e?o.push(e.proto.showCrosshair()):o.push(void 0)
return o},t.prototype.hideCrosshairs=function(){var t,i,e,n,o
for(n=this.template,o=[],t=0,i=n.length;t<i;t++)e=n[t],e?o.push(e.proto.hideCrosshair()):o.push(void 0)
return o},t.prototype.appendControls=function(t){var i,e,n,o
return o="plot-controls-"+t,i="",n='<ul id="'+o+'" class="unstyled" style="list-style-type: none; padding-left: 6px;"> </ul>',$(this.template[t].proto.options.target).find(".line-plot-controls").append(n),this.controls.move(t,"#"+o,"up"),this.controls.new("#"+o,"down"),this.controls.remove(t,"#"+o),this.controls.move(t,"#"+o,"down"),"station"===this.template[t].type?(e=[this.template[t].proto.options.y,this.template[t].proto.options.y2,this.template[t].proto.options.y3],this.controls.appendParameterDropdown(t,"#"+o,this.template[t].proto.options.y.dataLoggerId,e)):"parameter"===this.template[t].type?(e=[this.template[t].proto.options.y,this.template[t].proto.options.y2,this.template[t].proto.options.y3],this.controls.appendStationDropdown(t,"#"+o,this.template[t].proto.options.y.variable,e)):void 0},t.prototype.remove=function(t){return $(this.template[t].proto.options.target).fadeOut(500,function(){return $(this).remove()}),this.template[t]=null},t.prototype.move=function(t,i){var e,n,o
if(e=this.template[t].pageOrder,o=$(this.template[t].proto.options.target),"up"===i){if(e>1)return n=this.indexOfValue(this.template,"pageOrder",e-1),this.template[t].pageOrder--,this.template[n].pageOrder++,o.prev().insertAfter(o)}else if("down"===i&&e<this.template.length)return n=this.indexOfValue(this.template,"pageOrder",e+1),this.template[t].pageOrder++,this.template[n].pageOrder--,o.next().insertBefore(o)},t.prototype.add=function(t){var i,e,n,o,a,s
if(this.template[this.template.length-1].proto.initialized!==!1)return o=this.utarget(this.options.target),n={plotOrder:this.template.length,type:t},e={target:"#"+o,type:t,x:{variable:"datetime"}},a='<div id="'+o+'"></div>',$(this.options.target).append(a),i=this.template.push(n)-1,s=new window.Plotting.LinePlot(this,[],e),s.preAppend(),this.template[i].proto=s,this.template[i].proto.options.plotId=i,this.template[i].proto.initialized?this.appendControls(i):void 0},t.prototype.initVariable=function(t,i,e){return this.template[t].dataParams=[this.template[t-1].dataParams[0]],this.template[t].dataParams[0].data_logger=null,this.template[t].proto.options.y.variable=i,this.template[t].proto.options.y.title=e,this.appendControls(t),this.template[t].proto.removeTemp()},t.prototype.appendNew=function(t,i){var e
return e=this.template[t],e.dataParams[0].data_logger=i,e.proto.options.dataParams=e.dataParams,e.proto.options.y.dataLoggerId=i,this.getAppendData(this.uuid(),t,0)},t.prototype.setNewOptions=function(t,i,e){var n,o
if(n=this.getVariableBounds(i),o=this.getVariableInfo(i),null===this.template[t].proto.options.y.variable){if(this.template[t].proto.options.y={dataLoggerId:e,variable:i,color:this.getColor("light",parseInt(t))},"wind_speed_average"===i&&(this.template[t].proto.options.yBand.minVariable="wind_speed_minimum",this.template[t].proto.options.yBand.maxVariable="wind_speed_maximum"),o&&(this.template[t].proto.options.y.title=o.title,this.template[t].proto.options.y.units=o.units),n)return this.template[t].proto.options.y.min=n.min,this.template[t].proto.options.y.max=n.max}else if(null===this.template[t].proto.options.y2.variable){if(this.template[t].proto.options.y2={dataLoggerId:e,variable:i,color:this.getColor("light",parseInt(t)+4)},"wind_speed_average"===i&&(this.template[t].proto.options.y2Band.minVariable="wind_speed_minimum_2",this.template[t].proto.options.y2Band.maxVariable="wind_speed_maximum_2"),o&&(this.template[t].proto.options.y2.title=o.title,this.template[t].proto.options.y2.units=o.units),n)return this.template[t].proto.options.y2.min=n.min,this.template[t].proto.options.y2.max=n.max}else if(null===this.template[t].proto.options.y3.variable&&(this.template[t].proto.options.y3={dataLoggerId:e,variable:i,color:this.getColor("light",parseInt(t)+6)},"wind_speed_average"===i&&(this.template[t].proto.options.y3Band.minVariable="wind_speed_minimum_3",this.template[t].proto.options.y3Band.maxVariable="wind_speed_maximum_3"),o&&(this.template[t].proto.options.y3.title=o.title,this.template[t].proto.options.y3.units=o.units),n))return this.template[t].proto.options.y3.min=n.min,this.template[t].proto.options.y3.max=n.max},t.prototype.getVariableBounds=function(t){var i
return i={battery_voltage:{min:8,max:16},net_solar:{min:0,max:800},relative_humidity:{min:0,max:100},snow_depth:{min:0,max:40},wind_direction:{min:0,max:360},precipitation:{min:0,max:.7},temperature:{min:0,max:60},wind_speed_average:{min:0,max:60}},i[t]},t.prototype.getVariableInfo=function(t){var i
return i={battery_voltage:{title:"Battery Voltage",units:"V"},net_solar:{title:"Solar Radiation",units:"W/m2"},relative_humidity:{title:"Relative Humidity",units:"%"},barometric_pressure:{title:"Barometric Pressure",units:"atm"},snow_depth:{title:"Snow Depth",units:'"'},wind_direction:{title:"Wind Direction",units:""},precipitation:{title:"Precipitation",units:'"'},temperature:{title:"Temperature",units:"F"},wind_speed_average:{title:"Wind Speed",units:"mph"}},i[t]},t.prototype.getColor=function(t,i){return this.options.colors[t][i]},t.prototype.getTitle=function(t){var i
return i={},"station"===t.type?(i.title=t.station.station,i.subtitle=""):"parameter"===t.type&&(i.title=t.options.y.title,i.subtitle=""),i},t.prototype.indexOfValue=function(t,i,e){var n,o,a,s
for(o=-1,n=a=0,s=t.length-1;0<=s?a<=s:a>=s;n=0<=s?++a:--a)t[n][i]===e&&(o=n)
return o},t.prototype.uuid=function(){return(4294967296*(1+Math.random())|0).toString(16).substring(1)},t.prototype.utarget=function(t){return t=t.replace("#",""),t+"-"+this.uuid()},t}()}.call(this)
